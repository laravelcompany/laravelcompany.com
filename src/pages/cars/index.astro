---
import MainLayout from "../../layouts/MainLayout.astro";
import SearchForm from "../../components/ui/SearchForm.astro";
import { getCollection } from 'astro:content';
import type { CollectionEntry } from "astro:content";
import CarsCard from "../../components/ui/CarsCard.astro";

// Fetch all software entries from the 'cars' collection
const allCars: CollectionEntry<'cars'>[] = await getCollection('cars');

// SEO keywords from provided data
const keywords = [
  "software for tuning cars",
  "car tuning software",
  "tune software car",
  "remap ecu",
  "remapping the ecu",
  "ecu remap",
  "ecu remapper",
  "remapping ecu",
  "remapping of ecu"
];

// SEO metadata
const seo = {
  title: "Car ECU Tuning Software & Remapping Tools",
  description: "Download top ECU remapping and car tuning software. Optimize your vehicle's performance with our trusted ECU tools and databases.",
  keywords: keywords.join(", "),
};

// Structured data for SEO (JSON-LD)
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": seo.title,
  "description": seo.description,
  "keywords": seo.keywords,
  "url": "https://laravelcompany.com/cars", // Replace with your actual URL
};
---

<MainLayout
  title={seo.title}
  description={seo.description}
  keywords={seo.keywords}
>
  <!-- Structured Data for SEO -->
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

  <main class="space-y-12 bg-gray-50 py-10">
    <!-- Hero Section -->
    <section
      class="py-12 px-4 mx-auto max-w-screen-xl lg:py-16 lg:px-6 text-center"
      aria-labelledby="hero-title"
    >
      <h1
        id="hero-title"
        class="mb-4 text-3xl lg:text-4xl tracking-tight font-extrabold text-gray-900"
      >
        Download Car ECU Tuning Software
      </h1>
      <p class="font-light text-gray-600 sm:text-xl max-w-2xl mx-auto">
        Discover professional ECU remapping and car tuning software to optimize
        your vehicle's performance. Explore our database of trusted tools today.
      </p>
    </section>

    <!-- Search Form Section -->
    <section class="px-4 mx-auto max-w-screen-md" aria-label="Search ECU Software">
      <SearchForm aria-label="Search for ECU tuning software" />
    </section>

    <!-- Software List Section -->
    <section
      class="px-4 mx-auto max-w-screen-xl"
      aria-labelledby="software-list-title"
    >
      <h2
        id="software-list-title"
        class="sr-only"
        class="mb-6 text-2xl font-semibold text-gray-900"
      >
        Available ECU Tuning Software
      </h2>

      <!-- Software Grid or Empty State -->
      {allCars.length > 0 ? (
        <div class="grid gap-8 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
          {allCars.map((soft) => (
            <CarsCard
              car={soft}
              aria-label={`View details for ${soft.data.title}`}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-8">
          <p class="text-lg text-gray-600">
            No ECU tuning software available at the moment. Check back later or try
            a different search.
          </p>
        </div>
      )}
    </section>

    <!-- Pagination Placeholder (Optional) -->
    {allCars.length > 9 && (
      <section
        class="px-4 mx-auto max-w-screen-xl text-center"
        aria-label="Pagination"
      >
        <nav aria-label="Page navigation for ECU software">
          <ul class="inline-flex space-x-2">
            <li>
              <button
                class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"
                aria-label="Previous page"
                disabled
              >
                Previous
              </button>
            </li>
            <li>
              <button
                class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"
                aria-label="Next page"
              >
                Next
              </button>
            </li>
          </ul>
        </nav>
      </section>
    )}

    <!-- FAQ Section for SEO and User Engagement -->
    <section
      class="px-4 mx-auto max-w-screen-xl"
      aria-labelledby="faq-title"
    >
      <h2
        id="faq-title"
        class="mb-6 text-2xl font-semibold text-gray-900 text-center"
      >
        Frequently Asked Questions
      </h2>
      <div class="space-y-4">
        <details
          class="p-4 bg-white rounded-lg shadow"
          open={false}
        >
          <summary class="font-medium text-gray-900 cursor-pointer">
            What is ECU remapping?
          </summary>
          <p class="mt-2 text-gray-600">
            ECU remapping involves modifying the software in your vehicle's Engine
            Control Unit (ECU) to enhance performance, fuel efficiency, or
            drivability. Our software for tuning cars makes this process seamless.
          </p>
        </details>
        <details
          class="p-4 bg-white rounded-lg shadow"
          open={false}
        >
          <summary class="font-medium text-gray-900 cursor-pointer">
            How does car tuning software work?
          </summary>
          <p class="mt-2 text-gray-600">
            Car tuning software allows you to adjust parameters like fuel injection
            and ignition timing in the ECU. Tools like our ECU remappers provide
            user-friendly interfaces for precise tuning.
          </p>
        </details>
      </div>
    </section>
  </main>
</MainLayout>

<style>
  /* Custom styles for improved design */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    border: 0;
  }

  details summary::-webkit-details-marker {
    display: none;
  }

  details summary::before {
    content: "â–¶ ";
    display: inline-block;
    transition: transform 0.2s;
  }

  details[open] summary::before {
    transform: rotate(90deg);
  }
</style>